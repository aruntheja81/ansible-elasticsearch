---
- name: Configure Elastic APT key
  apt_key: url=https://packages.elastic.co/GPG-KEY-elasticsearch
           state=present

- name: Configure the Elastic APT repositories
  apt_repository: repo="deb http://packages.elastic.co/elasticsearch/{{ elasticsearch_short_version }}/debian stable main"
                  state=present

- name: Install Elasticsearch
  apt: pkg="elasticsearch={{ elasticsearch_version }}"
       state=present

- name: Configure Elasticsearch defaults
  template: src=elasticsearch.j2
            dest=/etc/default/elasticsearch
  notify:
    - Restart Elasticsearch

- name: Configure Elasticsearch
  template: src=elasticsearch.yml.j2
            dest=/etc/elasticsearch/elasticsearch.yml
  notify:
    - Restart Elasticsearch

- name: Enable Elasticsearch service
  service: name=elasticsearch enabled=yes
